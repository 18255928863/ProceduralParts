PART
{
	// --- general parameters ---
	name = proceduralTankLiquid
	module = Part
	author = AncientGammoner, NathanKell, SwampIg

	// --- asset parameters ---
	MODEL
	{
		model = ProceduralTanks/Parts/cylinderTank
		scale = 1,1,1
	}
	scale = 1
	rescaleFactor = 1

	// --- node definitions ---
	node_stack_top=0,0.5,0,0,1,0,1
	node_stack_bottom=0,-0.5,0,0,-1,0,1
	node_attach=0,0,0.5,0,0,-1,1

	// --- editor parameters ---
	cost = 4000
	TechRequired = basicRocketry
	entryCost = 4000
	category = Propulsion
	subcategory = 0
	title = Procedural Liquid Tank
	manufacturer = Kerbchem Industries
	description = Made from viscoelastic nanopolymers (which were discovered by accident... growing in the back of the office mini-fridge) this fuel tank can be stretched to accommodate fuel loads of a range of sizes and shapes. Hardens to a rigid structure before launch!

	// attachment rules: stack, srfAttach, allowStack, allowSrfAttach, allowCollision
	attachRules = 1,1,1,1,0

	// --- standard part parameters ---
	mass = 0.175
	dragModelType = default
	maximum_drag = 0.2
	minimum_drag = 0.3
	angularDrag = 2
	crashTolerance = 10
	breakingForce = 500
	breakingTorque = 500
	maxTemp = 1450

	RESOURCE
	{
		name = LiquidFuel
		amount = 126
		maxAmount = 126
	}

	RESOURCE
	{
		name = Oxidizer
		amount = 154
		maxAmount = 154
	}

	MODULE
	{
		name = ProceduralTank
		
		TECHLIMIT {
			// FL-200 - 1.25 x 1.1105 m = 1.363 kL
			TechRequired = start
			diameterMin = 1.0
			diameterMax = 1.5
			lengthMin = 1.0
			lengthMax = 1.5
			volumeMin = 1.0
			volumeMax = 1.5
		}
		TECHLIMIT {
			// FL-T400 - 1.25 x 1.87819 m = 2.305 kL
			// FL-T100 - 1.25 x 0.78125 m = 0.959 kL
			TechRequired = basicRocketry
			lengthMin = 0.5
			lengthMax = 2.0
			volumeMin = 0.75
			volumeMax = 2.5
		}
		TECHLIMIT {
			// FL-T800 - 1.25 x 3.75 m = 4.602 kL
			TechRequired = advRocketry
			lengthMax = 4.0
			volumeMax = 5.0
		}
		TECHLIMIT {
			// X200-16 - 2.5 x 1.875 m = 9.204 kL
			TechRequired = heavyRocketry
			diameterMax = 3.0
			volumeMax = 10.0
		}
		TECHLIMIT {
			// X200-32 - 2.5 x 3.75 m = 18.408 kL
			TechRequired = heavierRocketry
			volumeMax = 20.0
		}
		TECHLIMIT {
			// Jumbo-64 - 2.5 x 7.5 m = 36.816 kL
			TechRequired = veryHeavyRocketry
			lengthMax = 8
			volumeMax = 40.0
		}
		
		TECHLIMIT {
			// Not in main sequence. Depends indirectly off basicRocketry only
			// X200-8 - 2.5 x 0.9375 m = 4.602 kL
			TechRequired = advConstruction
			diameterMax = 3.0
			volumeMax = 5.0
		}
		
		TECHLIMIT {
			// Not in main sequence. Depends indirectly off basicRocketry
			// Oscar-B - 0.625 x 0.3485474 m = 0.107 kL
			TechRequired = precisionEngineering
			diameterMin = 0.125
			lengthMin = 0.125
			volumeMin = 0.0625
		}
		
		TECHLIMIT {
			// Make everything unlimited for metaMaterials
			TechRequired = metaMaterials
			diameterMin = 0.01
			diameterMax = Infinity
			lengthMin = 0.01
			lengthMax = Infinity
			volumeMin = 0.01
			volumeMax = Infinity
		}
	}
	MODULE
	{
		name = ProceduralTankShapeCylinder
		displayName = Cylinder
		TechRequired = start
		
		length = 1.0
		diameter = 1.25
	}
	MODULE 
	{
		name = ProceduralTankShapeCone
		displayName = Cone
		TechRequired = advRocketry
		
		length = 1.0
		topDiameter = 0.5
		bottomDiameter = 1.25
	}
	MODULE
	{
		name = TankContentSwitcher
		
		// All the X200 series, plus the FL-T800 have the same dry density and resource units per kL
		TANK_TYPE_OPTION 
		{
			optionName = Mixed
			dryDensity = 0.1089
			resources 
			{
				{
					resourceName = LiquidFuel
					unitsPerKL = 78.22784
				}
				{
					resourceName = Oxidizer
					unitsPerKL = 95.6118
				}					
			}
		}
		
		// Stock tanks you end up paying a hefty penalty both in dry mass and fill to use
		// a liquid fuel tank. You're better off getting a mixed tank and tweaking the 
		// oxidizer to empty.  Have made up some more sensible values - dry density would
		// be lower since there's only one tank, plus fill would be higher
		TANK_TYPE_OPTION 
		{
			optionName = LiquidFuel
			dryDensity = 0.1
			// As per StretchySRB 
			// dryDensity = 0.0450
			resources 
			{
				{
					resourceName = LiquidFuel
					unitsPerKL = 180
					// As per StretchySRB
					// unitsPerKL = 49.9789
				}
			}
		}
		TANK_TYPE_OPTION
		{
			optionName = Oxidizer
			dryDensity = 0.1
			//0.0815
			resources 
			{
				{
					resourceName = Oxidizer
					unitsPerKL = 180
					// As per StretchySRB
					// unitsPerKL = 81.4873
				}
			}
		}
	}
}